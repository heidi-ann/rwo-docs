<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="next" href="Command.Deprecated.html">
<link rel="Up" href="Command.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Array_permute" rel="Chapter" href="Array_permute.html">
<link title="Avltree" rel="Chapter" href="Avltree.html">
<link title="Backtrace" rel="Chapter" href="Backtrace.html">
<link title="Bag" rel="Chapter" href="Bag.html">
<link title="Bigbuffer" rel="Chapter" href="Bigbuffer.html">
<link title="Bigbuffer_internal" rel="Chapter" href="Bigbuffer_internal.html">
<link title="Bigstring" rel="Chapter" href="Bigstring.html">
<link title="Bigstring_marshal" rel="Chapter" href="Bigstring_marshal.html">
<link title="Bigsubstring" rel="Chapter" href="Bigsubstring.html">
<link title="Binable" rel="Chapter" href="Binable.html">
<link title="Binable0" rel="Chapter" href="Binable0.html">
<link title="Binary_packing" rel="Chapter" href="Binary_packing.html">
<link title="Blang" rel="Chapter" href="Blang.html">
<link title="Bool" rel="Chapter" href="Bool.html">
<link title="Bounded_int_table" rel="Chapter" href="Bounded_int_table.html">
<link title="Bucket" rel="Chapter" href="Bucket.html">
<link title="Byte_units" rel="Chapter" href="Byte_units.html">
<link title="Caml" rel="Chapter" href="Caml.html">
<link title="Command" rel="Chapter" href="Command.html">
<link title="Common" rel="Chapter" href="Common.html">
<link title="Commutative_group" rel="Chapter" href="Commutative_group.html">
<link title="Comparable" rel="Chapter" href="Comparable.html">
<link title="Comparable_intf" rel="Chapter" href="Comparable_intf.html">
<link title="Comparator" rel="Chapter" href="Comparator.html">
<link title="Constrained_float" rel="Chapter" href="Constrained_float.html">
<link title="Container" rel="Chapter" href="Container.html">
<link title="Core_arg" rel="Chapter" href="Core_arg.html">
<link title="Core_array" rel="Chapter" href="Core_array.html">
<link title="Core_bin_prot" rel="Chapter" href="Core_bin_prot.html">
<link title="Core_char" rel="Chapter" href="Core_char.html">
<link title="Core_condition" rel="Chapter" href="Core_condition.html">
<link title="Core_field" rel="Chapter" href="Core_field.html">
<link title="Core_filename" rel="Chapter" href="Core_filename.html">
<link title="Core_gc" rel="Chapter" href="Core_gc.html">
<link title="Core_hashtbl" rel="Chapter" href="Core_hashtbl.html">
<link title="Core_hashtbl_intf" rel="Chapter" href="Core_hashtbl_intf.html">
<link title="Core_int" rel="Chapter" href="Core_int.html">
<link title="Core_int32" rel="Chapter" href="Core_int32.html">
<link title="Core_int63" rel="Chapter" href="Core_int63.html">
<link title="Core_int64" rel="Chapter" href="Core_int64.html">
<link title="Core_lazy" rel="Chapter" href="Core_lazy.html">
<link title="Core_list" rel="Chapter" href="Core_list.html">
<link title="Core_map" rel="Chapter" href="Core_map.html">
<link title="Core_map_intf" rel="Chapter" href="Core_map_intf.html">
<link title="Core_map_unit_tests" rel="Chapter" href="Core_map_unit_tests.html">
<link title="Core_mutex" rel="Chapter" href="Core_mutex.html">
<link title="Core_nativeint" rel="Chapter" href="Core_nativeint.html">
<link title="Core_printexc" rel="Chapter" href="Core_printexc.html">
<link title="Core_printf" rel="Chapter" href="Core_printf.html">
<link title="Core_queue" rel="Chapter" href="Core_queue.html">
<link title="Core_random" rel="Chapter" href="Core_random.html">
<link title="Core_set" rel="Chapter" href="Core_set.html">
<link title="Core_set_intf" rel="Chapter" href="Core_set_intf.html">
<link title="Core_set_unit_tests" rel="Chapter" href="Core_set_unit_tests.html">
<link title="Core_sexp" rel="Chapter" href="Core_sexp.html">
<link title="Core_stack" rel="Chapter" href="Core_stack.html">
<link title="Core_string" rel="Chapter" href="Core_string.html">
<link title="Core_sys" rel="Chapter" href="Core_sys.html">
<link title="Core_thread" rel="Chapter" href="Core_thread.html">
<link title="Core_unix" rel="Chapter" href="Core_unix.html">
<link title="Core_weak" rel="Chapter" href="Core_weak.html">
<link title="Crc" rel="Chapter" href="Crc.html">
<link title="Daemon" rel="Chapter" href="Daemon.html">
<link title="Date" rel="Chapter" href="Date.html">
<link title="Day_of_week" rel="Chapter" href="Day_of_week.html">
<link title="Dequeue" rel="Chapter" href="Dequeue.html">
<link title="Doubly_linked" rel="Chapter" href="Doubly_linked.html">
<link title="Equal" rel="Chapter" href="Equal.html">
<link title="Error" rel="Chapter" href="Error.html">
<link title="Exn" rel="Chapter" href="Exn.html">
<link title="Flags" rel="Chapter" href="Flags.html">
<link title="Flags_intf" rel="Chapter" href="Flags_intf.html">
<link title="Float" rel="Chapter" href="Float.html">
<link title="Floatable" rel="Chapter" href="Floatable.html">
<link title="Float_intf" rel="Chapter" href="Float_intf.html">
<link title="Float_robust_compare" rel="Chapter" href="Float_robust_compare.html">
<link title="Fn" rel="Chapter" href="Fn.html">
<link title="Force_once" rel="Chapter" href="Force_once.html">
<link title="Fqueue" rel="Chapter" href="Fqueue.html">
<link title="Hashable" rel="Chapter" href="Hashable.html">
<link title="Hash_heap" rel="Chapter" href="Hash_heap.html">
<link title="Hash_queue" rel="Chapter" href="Hash_queue.html">
<link title="Hash_set" rel="Chapter" href="Hash_set.html">
<link title="Hash_set_intf" rel="Chapter" href="Hash_set_intf.html">
<link title="Heap" rel="Chapter" href="Heap.html">
<link title="Heap_block" rel="Chapter" href="Heap_block.html">
<link title="Host_and_port" rel="Chapter" href="Host_and_port.html">
<link title="Identifiable" rel="Chapter" href="Identifiable.html">
<link title="In_channel" rel="Chapter" href="In_channel.html">
<link title="Info" rel="Chapter" href="Info.html">
<link title="Intable" rel="Chapter" href="Intable.html">
<link title="Int_conversions" rel="Chapter" href="Int_conversions.html">
<link title="Interfaces" rel="Chapter" href="Interfaces.html">
<link title="Interned_string" rel="Chapter" href="Interned_string.html">
<link title="Interval" rel="Chapter" href="Interval.html">
<link title="Interval_intf" rel="Chapter" href="Interval_intf.html">
<link title="Int_intf" rel="Chapter" href="Int_intf.html">
<link title="Int_math" rel="Chapter" href="Int_math.html">
<link title="Int_replace_polymorphic_compare" rel="Chapter" href="Int_replace_polymorphic_compare.html">
<link title="Int_set" rel="Chapter" href="Int_set.html">
<link title="Invariant" rel="Chapter" href="Invariant.html">
<link title="Iobuf" rel="Chapter" href="Iobuf.html">
<link title="Iobuf_debug" rel="Chapter" href="Iobuf_debug.html">
<link title="Iobuf_intf" rel="Chapter" href="Iobuf_intf.html">
<link title="Iobuf_tests" rel="Chapter" href="Iobuf_tests.html">
<link title="Linux_ext" rel="Chapter" href="Linux_ext.html">
<link title="Lock_file" rel="Chapter" href="Lock_file.html">
<link title="Make_substring" rel="Chapter" href="Make_substring.html">
<link title="Memo" rel="Chapter" href="Memo.html">
<link title="Monad" rel="Chapter" href="Monad.html">
<link title="Month" rel="Chapter" href="Month.html">
<link title="Mutex0" rel="Chapter" href="Mutex0.html">
<link title="Nano_mutex" rel="Chapter" href="Nano_mutex.html">
<link title="Never_returns" rel="Chapter" href="Never_returns.html">
<link title="No_polymorphic_compare" rel="Chapter" href="No_polymorphic_compare.html">
<link title="Nothing" rel="Chapter" href="Nothing.html">
<link title="Nothing0" rel="Chapter" href="Nothing0.html">
<link title="Ofday" rel="Chapter" href="Ofday.html">
<link title="Only_in_test" rel="Chapter" href="Only_in_test.html">
<link title="Option" rel="Chapter" href="Option.html">
<link title="Ordered_collection_common" rel="Chapter" href="Ordered_collection_common.html">
<link title="Ordering" rel="Chapter" href="Ordering.html">
<link title="Or_error" rel="Chapter" href="Or_error.html">
<link title="Out_channel" rel="Chapter" href="Out_channel.html">
<link title="Pid" rel="Chapter" href="Pid.html">
<link title="Piecewise_linear" rel="Chapter" href="Piecewise_linear.html">
<link title="Piecewise_linear_intf" rel="Chapter" href="Piecewise_linear_intf.html">
<link title="Polymorphic_compare" rel="Chapter" href="Polymorphic_compare.html">
<link title="Polymorphic_compare_intf" rel="Chapter" href="Polymorphic_compare_intf.html">
<link title="Pretty_printer" rel="Chapter" href="Pretty_printer.html">
<link title="Process_env" rel="Chapter" href="Process_env.html">
<link title="Quickcheck" rel="Chapter" href="Quickcheck.html">
<link title="Ref" rel="Chapter" href="Ref.html">
<link title="Result" rel="Chapter" href="Result.html">
<link title="Robustly_comparable" rel="Chapter" href="Robustly_comparable.html">
<link title="Set_once" rel="Chapter" href="Set_once.html">
<link title="Sexpable" rel="Chapter" href="Sexpable.html">
<link title="Signal" rel="Chapter" href="Signal.html">
<link title="Source_code_position" rel="Chapter" href="Source_code_position.html">
<link title="Source_code_position0" rel="Chapter" href="Source_code_position0.html">
<link title="Span" rel="Chapter" href="Span.html">
<link title="Squeue" rel="Chapter" href="Squeue.html">
<link title="Stable" rel="Chapter" href="Stable.html">
<link title="Stable_containers" rel="Chapter" href="Stable_containers.html">
<link title="Stable_internal" rel="Chapter" href="Stable_internal.html">
<link title="Stable_unit_test" rel="Chapter" href="Stable_unit_test.html">
<link title="Stable_unit_test_intf" rel="Chapter" href="Stable_unit_test_intf.html">
<link title="Staged" rel="Chapter" href="Staged.html">
<link title="Std" rel="Chapter" href="Std.html">
<link title="Std_common" rel="Chapter" href="Std_common.html">
<link title="Std_kernel" rel="Chapter" href="Std_kernel.html">
<link title="Std_internal" rel="Chapter" href="Std_internal.html">
<link title="Stringable" rel="Chapter" href="Stringable.html">
<link title="String_id" rel="Chapter" href="String_id.html">
<link title="Substring" rel="Chapter" href="Substring.html">
<link title="Substring_intf" rel="Chapter" href="Substring_intf.html">
<link title="T" rel="Chapter" href="T.html">
<link title="Thread_safe_queue" rel="Chapter" href="Thread_safe_queue.html">
<link title="Time" rel="Chapter" href="Time.html">
<link title="Time_internal" rel="Chapter" href="Time_internal.html">
<link title="Timer" rel="Chapter" href="Timer.html">
<link title="Timing_wheel" rel="Chapter" href="Timing_wheel.html">
<link title="Timing_wheel_intf" rel="Chapter" href="Timing_wheel_intf.html">
<link title="Timing_wheel_unit_tests" rel="Chapter" href="Timing_wheel_unit_tests.html">
<link title="Tuple" rel="Chapter" href="Tuple.html">
<link title="Type_equal" rel="Chapter" href="Type_equal.html">
<link title="Union_find" rel="Chapter" href="Union_find.html">
<link title="Unique_id" rel="Chapter" href="Unique_id.html">
<link title="Unique_id_intf" rel="Chapter" href="Unique_id_intf.html">
<link title="Unit" rel="Chapter" href="Unit.html">
<link title="Univ" rel="Chapter" href="Univ.html">
<link title="Univ_map" rel="Chapter" href="Univ_map.html">
<link title="Unpack_buffer" rel="Chapter" href="Unpack_buffer.html">
<link title="User_and_group" rel="Chapter" href="User_and_group.html">
<link title="Uuid" rel="Chapter" href="Uuid.html">
<link title="Validate" rel="Chapter" href="Validate.html">
<link title="With_return" rel="Chapter" href="With_return.html">
<link title="Word_size" rel="Chapter" href="Word_size.html">
<link title="Zone" rel="Chapter" href="Zone.html"><link title="command parameters" rel="Section" href="#1_commandparameters">
<link title="command specifications" rel="Section" href="#1_commandspecifications">
<link title="argument types" rel="Section" href="#1_argumenttypes">
<link title="flag specifications" rel="Section" href="#1_flagspecifications">
<link title="anonymous argument specifications" rel="Section" href="#1_anonymousargumentspecifications">
<link title="various internal values" rel="Subsection" href="#2_variousinternalvalues">
<title>Command.Spec</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="Command.html" title="Command">Up</a>
&nbsp;<a class="post" href="Command.Deprecated.html" title="Command.Deprecated">Next</a>
</div>
<h1>Module <a href="type_Command.Spec.html">Command.Spec</a></h1>
<pre><span class="keyword">module</span> Spec: <code class="code">sig</code> <a href="Command.Spec.html">..</a> <code class="code">end</code></pre><div class="info">
composable command-line specifications<br>
</div>
<hr width="100%">
<br>
<h1 id="1_commandparameters">command parameters</h1><br>
<pre><span id="TYPEparam"><span class="keyword">type</span> <code class="type">'a</code> param</span> </pre>
<div class="info">
specification of an individual parameter to the command's main function<br>
</div>

<pre><span id="VALconst"><span class="keyword">val</span> const</span> : <code class="type">'a -> 'a <a href="Command.Spec.html#TYPEparam">param</a></code></pre><div class="info">
a hard-coded parameter<br>
</div>
<pre><span id="VALmap"><span class="keyword">val</span> map</span> : <code class="type">'a <a href="Command.Spec.html#TYPEparam">param</a> -> f:('a -> 'b) -> 'b <a href="Command.Spec.html#TYPEparam">param</a></code></pre><div class="info">
parameter transformation<br>
</div>
<br>
<h2 id="2_variousinternalvalues">various internal values</h2><br>
<pre><span id="VALhelp"><span class="keyword">val</span> help</span> : <code class="type">string Core_kernel.Std.Lazy.t <a href="Command.Spec.html#TYPEparam">param</a></code></pre><div class="info">
the help text for the command<br>
</div>
<pre><span id="VALpath"><span class="keyword">val</span> path</span> : <code class="type">string list <a href="Command.Spec.html#TYPEparam">param</a></code></pre><div class="info">
the subcommand path of the command<br>
</div>
<pre><span id="VALargs"><span class="keyword">val</span> args</span> : <code class="type">string list <a href="Command.Spec.html#TYPEparam">param</a></code></pre><div class="info">
the arguments passed to the command<br>
</div>
<br>
<h1 id="1_commandspecifications">command specifications</h1><br>
<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type">('main_in, 'main_out)</code> t</span> </pre>
<div class="info">
composable command-line specifications
<p>
Ultimately one forms a base command by combining a spec of type <code class="code">('main, unit) t</code>
      with a main function of type <code class="code">'main</code>; see the <code class="code">basic</code> function below.  Combinators
      in this library incrementally build up the type of main according to what
      command-line parameters it expects, so the resulting type of <code class="code">main</code> is something
      like:
<p>

      <code class="code">arg1 -&gt; ... -&gt; argN -&gt; unit</code>
<p>

      It may help to think of <code class="code">('a, 'b) t</code> as a function space <code class="code">'a -&gt; 'b</code> embellished with
      information about:
<p>

      <ul>
<li>how to parse command line</li>
<li>what the command does and how to call it</li>
<li>how to auto-complete a partial command line</li>
</ul>

<p>

      One can view a value of type <code class="code">('main_in, 'main_out) t</code> as function that transforms a
      main function from type <code class="code">'main_in</code> to <code class="code">'main_out</code>, typically by supplying some
      arguments.  E.g. a value of type <code class="code">Spec.t</code> might have type:
<p>

     <pre class="codepre"><code class="code">       (arg1 -&gt; ... -&gt; argN -&gt; 'r, 'r) Spec.t
     </code></pre>
<p>

      Such a value can transform a main function of type <code class="code">arg1 -&gt; ... -&gt; argN -&gt; 'r</code> by
      supplying it argument values of type <code class="code">arg1</code>, ..., <code class="code">argn</code>, leaving a main function
      whose type is <code class="code">'r</code>.  In the end, <code class="code">Command.basic</code> takes a completed spec where <code class="code">'r =
      unit</code>, and hence whose type looks like:
<p>

      <pre class="codepre"><code class="code">        (arg1 -&gt; ... -&gt; argN -&gt; unit, unit) Spec.t
     </code></pre>
<p>

      A value of this type can fully apply a main function of type <code class="code">arg1 -&gt; ... -&gt; argN
      -&gt; unit</code> to all its arguments.
<p>

      The view of <code class="code">('main_in, main_out) Spec.t</code> as a function from <code class="code">'main_in</code> to
      <code class="code">'main_out</code> is directly reflected by the <code class="code">step</code> function, whose type is:
<p>

      <pre class="codepre"><code class="code">        val step : ('m1 -&gt; 'm2) -&gt; ('m1, 'm2) t
     </code></pre><br>
</div>

<br>
<code class="code">spec1 ++ spec2 ++ ... ++ specN</code> composes spec1 through specN.
<p>

      For example, if <code class="code">spec_a</code> and <code class="code">spec_b</code> have types:
<p>

      <pre class="codepre"><code class="code">        spec_a: (a1 -&gt; ... -&gt; aN -&gt; 'ra, 'ra) Spec.t
        spec_b: (b1 -&gt; ... -&gt; bM -&gt; 'rb, 'rb) Spec.t
      </code></pre>
<p>

      then <code class="code">spec_a ++ spec_b</code> has the following type:
<p>

      <pre class="codepre"><code class="code">        (a1 -&gt; ... -&gt; aN -&gt; b1 -&gt; ... -&gt; bM -&gt; 'rb, 'rb) Spec.t
      </code></pre>
<p>

      So, <code class="code">spec_a ++ spec_b</code> transforms a main function it by first supplying <code class="code">spec_a</code>'s
      arguments of type <code class="code">a1</code>, ..., <code class="code">aN</code>, and then supplying <code class="code">spec_b</code>'s arguments of type
      <code class="code">b1</code>, ..., <code class="code">bm</code>.
<p>

      One can understand <code class="code">++</code> as function composition by thinking of the type of specs
      as concrete function types, representing the transformation of a main function:
<p>

      <pre class="codepre"><code class="code">        spec_a: \/ra. (a1 -&gt; ... -&gt; aN -&gt; 'ra) -&gt; 'ra
        spec_b: \/rb. (b1 -&gt; ... -&gt; bM -&gt; 'rb) -&gt; 'rb
      </code></pre>
<p>

      Under this interpretation, the composition of <code class="code">spec_a</code> and <code class="code">spec_b</code> has type:
<p>

      <pre class="codepre"><code class="code">        spec_a ++ spec_b : \/rc. (a1 -&gt; ... -&gt; aN -&gt; b1 -&gt; ... -&gt; bM -&gt; 'rc) -&gt; 'rc
      </code></pre>
<p>

      And the implementation is just function composition:
<p>

      <pre class="codepre"><code class="code">        sa ++ sb = fun main -&gt; sb (sa main)
      </code></pre><br>
<pre><span id="VALempty"><span class="keyword">val</span> empty</span> : <code class="type">('m, 'm) <a href="Command.Spec.html#TYPEt">t</a></code></pre><div class="info">
the empty command-line spec<br>
</div>
<pre><span id="VAL(++)"><span class="keyword">val</span> (++)</span> : <code class="type">('m1, 'm2) <a href="Command.Spec.html#TYPEt">t</a> -><br>       ('m2, 'm3) <a href="Command.Spec.html#TYPEt">t</a> -> ('m1, 'm3) <a href="Command.Spec.html#TYPEt">t</a></code></pre><div class="info">
command-line spec composition<br>
</div>
<pre><span id="VAL(+>)"><span class="keyword">val</span> (+&gt;)</span> : <code class="type">('m1, 'a -> 'm2) <a href="Command.Spec.html#TYPEt">t</a> -><br>       'a <a href="Command.Spec.html#TYPEparam">param</a> -> ('m1, 'm2) <a href="Command.Spec.html#TYPEt">t</a></code></pre><div class="info">
add a rightmost parameter onto the type of main<br>
</div>
<pre><span id="VAL(+<)"><span class="keyword">val</span> (+&lt;)</span> : <code class="type">('m1, 'm2) <a href="Command.Spec.html#TYPEt">t</a> -><br>       'a <a href="Command.Spec.html#TYPEparam">param</a> -> ('a -> 'm1, 'm2) <a href="Command.Spec.html#TYPEt">t</a></code></pre><div class="info">
add a leftmost parameter onto the type of main
<p>
this function should only be used as a workaround in situations where the
        order of composition is at odds with the order of anonymous arguments due
        to factoring out some common spec<br>
</div>
<pre><span id="VALstep"><span class="keyword">val</span> step</span> : <code class="type">('m1 -> 'm2) -> ('m1, 'm2) <a href="Command.Spec.html#TYPEt">t</a></code></pre><div class="info">
combinator for patching up how parameters are obtained or presented
<p>
Here are a couple examples of some of its many uses
      <ul>
<li><i>introducing labeled arguments</i>
            <pre class="verbatim">step (fun m v -&gt; m ~foo:v)
               +&gt; flag "-foo" no_arg : (foo:bool -&gt; 'm, 'm) t</pre></li>
<li><i>prompting for missing values</i>
            <pre class="verbatim">step (fun m user -&gt; match user with
                 | Some user -&gt; m user
                 | None -&gt; print_string "enter username: "; m (read_line ()))
               +&gt; flag "-user" (optional string) ~doc:"USER to frobnicate"
               : (string -&gt; 'm, 'm) t</pre></li>
</ul>

<p>

      A use of <code class="code">step</code> might look something like:
<p>

      <pre class="codepre"><code class="code">        step (fun main -&gt; let ... in main x1 ... xN) : (arg1 -&gt; ... -&gt; argN -&gt; 'r, 'r) t
      </code></pre>
<p>

      Thus, <code class="code">step</code> allows one to write arbitrary code to decide how to transform a main
      function.  As a simple example:
<p>

      <pre class="codepre"><code class="code">        step (fun main -&gt; main 13.) : (float -&gt; 'r, 'r) t
      </code></pre>
<p>

      This spec is identical to <code class="code">const 13.</code>; it transforms a main function by supplying
      it with a single float argument, <code class="code">13.</code>.  As another example:
<p>

      <pre class="codepre"><code class="code">        step (fun m v -&gt; m ~foo:v) : (foo:'foo -&gt; 'r, 'foo -&gt; 'r) t
      </code></pre>
<p>

      This spec transforms a main function that requires a labeled argument into
      a main function that requires the argument unlabeled, making it easily composable
      with other spec combinators.<br>
</div>
<pre><span id="VALwrap"><span class="keyword">val</span> wrap</span> : <code class="type">(run:('m1 -> 'r1) -> main:'m2 -> 'r2) -><br>       ('m1, 'r1) <a href="Command.Spec.html#TYPEt">t</a> -> ('m2, 'r2) <a href="Command.Spec.html#TYPEt">t</a></code></pre><div class="info">
combinator for defining a class of commands with common behavior
<p>
Here are two examples of command classes defined using <code class="code">wrap</code>
      <ul>
<li><i>print top-level exceptions to stderr</i>
            <pre class="verbatim">wrap (fun ~run ~main -&gt;
                 Exn.handle_uncaught ~exit:true (fun () -&gt; run main)
               ) : ('m, unit) t -&gt; ('m, unit) t
            </pre></li>
<li><i>iterate over lines from stdin</i>
            <pre class="verbatim">wrap (fun ~run ~main -&gt;
                 In_channel.iter_lines stdin ~f:(fun line -&gt; run (main line))
               ) : ('m, unit) t -&gt; (string -&gt; 'm, unit) t
            </pre></li>
</ul>
<br>
</div>
<br>
<h1 id="1_argumenttypes">argument types</h1><br>
<pre><span class="keyword">module</span> <a href="Command.Spec.Arg_type.html">Arg_type</a>: <code class="code">sig</code> <a href="Command.Spec.Arg_type.html">..</a> <code class="code">end</code></pre><pre><span id="VALstring"><span class="keyword">val</span> string</span> : <code class="type">string <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a></code></pre><pre><span id="VALint"><span class="keyword">val</span> int</span> : <code class="type">int <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a></code></pre><pre><span id="VALfloat"><span class="keyword">val</span> float</span> : <code class="type">float <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a></code></pre><pre><span id="VALbool"><span class="keyword">val</span> bool</span> : <code class="type">bool <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a></code></pre><pre><span id="VALdate"><span class="keyword">val</span> date</span> : <code class="type"><a href="Date.html#TYPEt">Date.t</a> <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a></code></pre><pre><span id="VALtime_span"><span class="keyword">val</span> time_span</span> : <code class="type"><a href="Span.html#TYPEt">Span.t</a> <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a></code></pre><pre><span id="VALfile"><span class="keyword">val</span> file</span> : <code class="type">string <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a></code></pre><br>
<h1 id="1_flagspecifications">flag specifications</h1><br>
<pre><span id="TYPEflag"><span class="keyword">type</span> <code class="type">'a</code> flag</span> </pre>
<div class="info">
a flag specification<br>
</div>

<pre><span id="VALflag"><span class="keyword">val</span> flag</span> : <code class="type">?aliases:string list -><br>       string -> 'a <a href="Command.Spec.html#TYPEflag">flag</a> -> doc:string -> 'a <a href="Command.Spec.html#TYPEparam">param</a></code></pre><div class="info">
<code class="code">flag name spec ~doc</code> specifies a command that, among other things, takes a flag
      named <code class="code">name</code> on its command line.  <code class="code">doc</code> indicates the meaning of the flag.
<p>

      NOTE: the <code class="code">doc</code> for a flag which takes an argument should be of the form <code class="code">arg_name ^
      " " ^ description</code> where <code class="code">arg_name</code> describes the argument and <code class="code">description</code>
      describes the meaning of the flag.
<p>

      NOTE: flag names (including aliases) containing underscores will
            be rejected.  Use dashes instead.<br>
</div>
<pre><span id="VALrequired"><span class="keyword">val</span> required</span> : <code class="type">'a <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a> -> 'a <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
required flags must be passed exactly once<br>
</div>
<pre><span id="VALoptional"><span class="keyword">val</span> optional</span> : <code class="type">'a <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a> -> 'a option <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
optional flags may be passed at most once<br>
</div>
<pre><span id="VALoptional_with_default"><span class="keyword">val</span> optional_with_default</span> : <code class="type">'a -> 'a <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a> -> 'a <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
<code class="code">optional_with_default</code> flags may be passed at most once, and
      default to a given value<br>
</div>
<pre><span id="VALlisted"><span class="keyword">val</span> listed</span> : <code class="type">'a <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a> -> 'a list <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
<code class="code">listed</code> flags may be passed zero or more times<br>
</div>
<pre><span id="VALno_arg"><span class="keyword">val</span> no_arg</span> : <code class="type">bool <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
<code class="code">no_arg</code> flags may be passed at most once.  The boolean returned
      is true iff the flag is passed on the command line<br>
</div>
<pre><span id="VALno_arg_register"><span class="keyword">val</span> no_arg_register</span> : <code class="type">key:'a <a href="../core_kernel/Univ_map.With_default.Key.html">Core_kernel.Std.Univ_map.With_default.Key</a>.t -><br>       value:'a -> bool <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
<code class="code">no_arg_register ~key ~value</code> is like <code class="code">no_arg</code>, but associates <code class="code">value</code>
      with <code class="code">key</code> in the in the auto-completion environment<br>
</div>
<pre><span id="VALno_arg_abort"><span class="keyword">val</span> no_arg_abort</span> : <code class="type">exit:(unit -> <a href="../core_kernel/Std.html">Core_kernel.Std</a>.never_returns) -> unit <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
<code class="code">no_arg_abort ~exit</code> is like <code class="code">no_arg</code>, but aborts command-line parsing
      by calling <code class="code">exit</code>.  This flag type is useful for "help"-style flags that
      just print something and exit.<br>
</div>
<pre><span id="VALescape"><span class="keyword">val</span> escape</span> : <code class="type">string list option <a href="Command.Spec.html#TYPEflag">flag</a></code></pre><div class="info">
<code class="code">escape</code> flags may be passed at most once.  They cause the command
      line parser to abort and pass through all remaining command line
      arguments as the value of the flag.<br>
</div>
<pre><span id="VALflags_of_args_exn"><span class="keyword">val</span> flags_of_args_exn</span> : <code class="type">Core_kernel.Std.Arg.t list -> ('a, 'a) <a href="Command.Spec.html#TYPEt">t</a></code></pre><div class="info">
<code class="code">flags_of_args_exn args</code> creates a spec from <code class="code">Arg.t</code>s, for compatibility with
      ocaml's base libraries.  Fails if it encounters an arg that cannot be converted.
<p>

      NOTE: There is a difference in side effect ordering between <code class="code">Arg</code> and <code class="code">Command</code>.  In
      the <code class="code">Arg</code> module, flag handling functions embedded in <code class="code">Arg.t</code> values will be run in
      the order that flags are passed on the command line.  In the <code class="code">Command</code> module, using
      <code class="code">flags_of_args_exn flags</code>, they are evaluated in the order that the <code class="code">Arg.t</code> values
      appear in <code class="code">flags</code>.<br>
</div>
<br>
<h1 id="1_anonymousargumentspecifications">anonymous argument specifications</h1><br>
<pre><span id="TYPEanons"><span class="keyword">type</span> <code class="type">'a</code> anons</span> </pre>
<div class="info">
a specification of some number of anonymous arguments<br>
</div>

<pre><span id="VALanon"><span class="keyword">val</span> anon</span> : <code class="type">'a <a href="Command.Spec.html#TYPEanons">anons</a> -> 'a <a href="Command.Spec.html#TYPEparam">param</a></code></pre><div class="info">
<code class="code">anon spec</code> specifies a command that, among other things, takes
      the anonymous arguments specified by <code class="code">spec</code>.<br>
</div>
<pre><span id="VAL(%:)"><span class="keyword">val</span> (%:)</span> : <code class="type">string -> 'a <a href="Command.Spec.Arg_type.html#TYPEt">Arg_type.t</a> -> 'a <a href="Command.Spec.html#TYPEanons">anons</a></code></pre><div class="info">
<code class="code">(name %: typ)</code> specifies a required anonymous argument of type <code class="code">typ</code>.
      The <code class="code">name</code> is mentioned in the generated help for the command.<br>
</div>
<pre><span id="VALsequence"><span class="keyword">val</span> sequence</span> : <code class="type">'a <a href="Command.Spec.html#TYPEanons">anons</a> -> 'a list <a href="Command.Spec.html#TYPEanons">anons</a></code></pre><div class="info">
<code class="code">sequence anons</code> specifies a sequence of anonymous arguments.  An exception
      will be raised if <code class="code">anons</code> matches anything other than a fixed number of
      anonymous arguments<br>
</div>
<pre><span id="VALmaybe"><span class="keyword">val</span> maybe</span> : <code class="type">'a <a href="Command.Spec.html#TYPEanons">anons</a> -> 'a option <a href="Command.Spec.html#TYPEanons">anons</a></code></pre><div class="info">
<code class="code">(maybe anons)</code> indicates that some anonymous arguments are optional<br>
</div>
<pre><span id="VALmaybe_with_default"><span class="keyword">val</span> maybe_with_default</span> : <code class="type">'a -> 'a <a href="Command.Spec.html#TYPEanons">anons</a> -> 'a <a href="Command.Spec.html#TYPEanons">anons</a></code></pre><div class="info">
<code class="code">(maybe_with_default default anons)</code> indicates an optional anonymous
      argument with a default value<br>
</div>
<br>
<code class="code">t2</code>, <code class="code">t3</code>, and <code class="code">t4</code> each concatenate multiple anonymous argument
      specs into a single one. The purpose of these combinators is to allow
      for optional sequences of anonymous arguments.  Consider a command with
      usage:
<p>

      <pre class="verbatim">        main.exe FOO [BAR BAZ]
      </pre>
<p>

      where the second and third anonymous arguments must either both
      be there or both not be there.  This can be expressed as:
<p>

      <pre class="codepre"><code class="code">        t2 ("FOO" %: foo) (maybe (t2 ("BAR" %: bar) ("BAZ" %: baz)))]
       </code></pre>
<p>

      Sequences of 5 or more anonymous arguments can be built up using
      nested tuples:
<p>

      <pre class="codepre"><code class="code">        maybe (t3 a b (t3 c d e))
      </code></pre><br>
<pre><span id="VALt2"><span class="keyword">val</span> t2</span> : <code class="type">'a <a href="Command.Spec.html#TYPEanons">anons</a> -><br>       'b <a href="Command.Spec.html#TYPEanons">anons</a> -> ('a * 'b) <a href="Command.Spec.html#TYPEanons">anons</a></code></pre><pre><span id="VALt3"><span class="keyword">val</span> t3</span> : <code class="type">'a <a href="Command.Spec.html#TYPEanons">anons</a> -><br>       'b <a href="Command.Spec.html#TYPEanons">anons</a> -><br>       'c <a href="Command.Spec.html#TYPEanons">anons</a> -> ('a * 'b * 'c) <a href="Command.Spec.html#TYPEanons">anons</a></code></pre><pre><span id="VALt4"><span class="keyword">val</span> t4</span> : <code class="type">'a <a href="Command.Spec.html#TYPEanons">anons</a> -><br>       'b <a href="Command.Spec.html#TYPEanons">anons</a> -><br>       'c <a href="Command.Spec.html#TYPEanons">anons</a> -><br>       'd <a href="Command.Spec.html#TYPEanons">anons</a> -> ('a * 'b * 'c * 'd) <a href="Command.Spec.html#TYPEanons">anons</a></code></pre></body></html>