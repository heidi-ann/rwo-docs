<!DOCTYPE HTML>
<html>
<head>

<title>Fd</title>
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type"/>
<link rel="stylesheet" href="style.css" type="text/css"/>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"> </script>
<script type="text/javascript" src="doc_loader.js"> </script>
</head>
<body>

<h1>Module Fd</h1>
<pre><span class="keyword">module</span> Fd</pre><div class="info">An <code class="code">Fd.t</code> is a wrapper around a Unix file descriptor, with additional information
    about the kind of file descriptor and logic to ensure that we don't use a file
    descriptor that has been closed, or close a file descriptor that is in use.  Since
    Async uses multiple threads to make read/write and other system calls on file
    descriptors, and Unix reuses descriptors after they are closed, Async has to be very
    careful that the file descriptor passed to a system call is referring to the file it
    intends, and not some other completely unrelated file that Unix has decided to assign
    to the same descriptor.<br/>    Provided that one only accesses a file descriptor within the context of the functions
    below, <code class="code">Fd</code> guarantees that the file descriptor will not have been closed/reused and
    will correspond to the same file that it did when the <code class="code">Fd.t</code> was created:<br/>    <span class="verbatim">      with_file_descr
      with_file_descr_deferred
      syscall
      syscall_exn
      syscall_in_thread
      syscall_in_thread_exn
    </span><br/>    The <code class="code">Fd</code> module keeps track of which of these functions that are currently accessing
    the file descriptor, and ensures that any close happens after they complete.  Also,
    once close has been called, it refuses to provide further access to the file
    descriptor, either by returning a variant, `Already_closed, or raising an exception.<br/>    Some of the above functions take an optional <code class="code">?nonblocking:bool</code> argument.  The
    default is false, but if it is set to true, then before supplying the underlying
    <code class="code">file_descr</code>, the <code class="code">Fd</code> module will first call <code class="code">Unix.set_nonblock file_descr</code>, if it
    hasn't previously done so on that file descriptor.  This is intended to support making
    nonblocking system calls (e.g. connect, read, write) directly within async, without
    releasing the OCaml lock or the async lock, and without using another thread.</div>
<hr/>
<div file="Fd.html.contents" class="content_to_load"> </div>
</body>
</html>